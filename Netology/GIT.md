## Тут будут небольшие наброски по GIT 
#### Скучная теория
- Указатель HEAD
  HEAD — это указатель на текущую ветку, которая, в свою очередь, является указателем на последний коммит, сделанный в этой ветке. Это значит, что HEAD будет родителем       следующего созданного коммита. Как правило, самое простое считать HEAD снимком вашего последнего коммита.

- Индекс
  Индекс — это ваш следующий намеченный коммит. Мы также упоминали это понятие как «область подготовленных изменений» Git — то, что Git просматривает, когда вы выполняете git commit.
- Рабочий Каталог
  Наконец, у вас есть рабочий каталог. Два других дерева сохраняют свое содержимое эффективным, но неудобным способом внутри каталога .git. Рабочий Каталог распаковывает их в настоящие файлы, что упрощает для вас их редактирование. Считайте Рабочий Каталог песочницей, где вы можете опробовать изменения перед их коммитом в индекс (область подготовленных изменений) и затем в историю.   

  > [!NOTE]
  > Говоря простым языком :  
  > git init - Мы создаем Рабочий каталог.  
  > git add -  добавлыем файлы в индекс  
  > git commint - Делаем снимок файлов и перемещаем HEAD на наш комит в ветке где он был сделан.

- Первоначальная настройка.Задаеv Имя которые отображается автором и его почту.
   ```
  git config --global user.name "Vasya Pupkin"
  git config --global user.email vasya@localhost
  ```
- Если используем http и не хоти вводить пароль каждый раз.Сохраняет логин и пароль в файле в незашифрованном виде.
  ```
  git config --global credential.helper 'store --file ~/.my-credentials'
  ```
- Посмотреть статус git
  ```
  git status
  ```
-Посмотреть всю сторию
  ```
  git reflog 
  ```
- Вывести все ветки в графике
  ```
  git log --graph --simplify-by-decoration --all
  ```
- Посмотреть как настроены ветки слежения
  ```
  git branch -vv
  ```
  ahead - опережает.Это значит, что у нас есть два локальных коммита, которые не отправлены на сервер
  behind - отстает.Это значит, что на сервере есть один коммит, который мы ещё не слили   

- Удалить Все коммиты и откатиься на нужный
  ```
   git reset --hard номер_комита
  ```
- Переключене между комитами и ветками
  ```
  git checkout 
  ```
- Создать новую ветку
  ```
  git branch
  ``` 
- Посмотреть все коммиты
  ```
  git log
  ```
- Посмотреть содержимое конкретного коммита
   ```
  git show имя_коммита
  ```
#### Работа с удаленными ветками и репами

- Посмотерть всю инфу по удаленной репе
  ```
   git remote show имя_репы
  ```
- Посмотреть в какой я вете сейачс
  ```
  git branch --show-current
  ```
- Посмотреть все ветки
  ```
  git branch --all
  ```
- ПОСЛЕ REBASE ДЛЯ ПРИМЕНЕНИЯ ИЗМЕНЕНМЙ В УДАЛЕННОЙ РЕПЕ ПРИМЕНИТЬ
  ```
  git pull --force
  ```
- 

- Добавить дополнительную уделенную ветку в локальный репозиторий
  ```
  git remote add сслыка_на_ветку
  ```
- Посмотеть все ветки в удаленном репозитории
  ```
  git remote show имя_удаленного_репозитория
  ```
- Создать,связать удаленную ветку с локальной и провалится в нее
  ```
  git checkout имя_удаленной_ветки -b тия_ветка_как_будет_называться_локально
  git checkout 802/fileops -b 802-fileop
  ```

   
  #### Работа с логами
  - Посмотреть все логи между двумя комитами.Тут получается сравнение, визьмы тег 24 и тег 23 и покажи коммиты которые есть в теге 24,но нет в      теге 23
    ```
    git log --pretty=format:"%H %s" v0.12.23..v0.12.24
    ```

  - посмотреть все коммиты
    ```
    git log
    ```
  - посмотреть определенное кол-во комитов.Везде в log можно указывать колтчество комитов.
  
     ```
      git log -(количество коммитов)
      git log -5
      
      ```
  -   Посмотреть комиты с тем что изменили
      ```
      git log --patch -5
      ```
  - Посмотреть сколько сумарно произошло изменений в коммите с файлом(ами)

      ```
      git log --stat
      git log --stat -5
      ``` 
  - Поиск коммита с определенным словом в содержании файла
       ```
      git log -S "слово"
      ```
  - Поиск коммита с определенным словом в коммите
       ```
      git log --grep "слово"
      ```
  #### Удаление и изменение
- Заменить последний комит.Переписыват старый комит новым
  ```
  git commit --amend
  ```
- Найти все коммиты и стеджи
  ```
  git reflog
  ```
- Удалить файл
   ```
  git rm имя_файла
  ```
  - Вернуть файлы в состояние неотслеживаемых
  ```
  git restore --staged <файл>
  ```
  - Удалить все изменения в файле (вернуть к первозданному состоянию)
    ```
    git restore <file>
    ```
  
- Удалить из отслеживаемых (из индекса)
   ```
  git rm --cached имя_файла
  ```
- Запушить все локальные ветки
  ```
  git push origin --all
  git push origin --tags
  ```
### Проблемы при слиянии
- При конфликте выбираем автоматический режим https://nitaym.github.io/ourstheirs/

- чтобы выбрать изменения, сделанные в master
   ```
   git checkout --ours codefile.js
   ```
- чтобы выбрать изменения, сделанные в  ветке feature

   ```
   git checkout --theirs codefile.js
   ```
- Если есть пролемы при merge на табуляции можно использовать разные стратегии.Для этого используем ключ -X и далее саму статегию.-Xignore-all-space или -Xignore-space-change. Первый вариант полностью игнорирует пробелы при сравнении строк, второй рассматривает последовательности одного или нескольких символов пробелов как эквивалентные.
  ```
  git merge -Xignore-all-space ветка
  ```
- Если неверно смержил как вернуть файл в состояния слияния.
  ```
  git checkout --conflict=merge имя_конфликтного файла
  --conflict=merge имя_конфликтного файла
  ```
  --conflict=merge Покажет стандартный вывод при проблемах при слиянии
  --conflict=merge Дополнительно покажет базовый вариант.
- Показывает хеш , автора ,  дату время  и строчки в коммите (которые изменил автор)
- ```
  Git blame <файл> -L 12,16 
  ```
  ключ -C  для включения в вывод  первоисточника кода  (возможного)

### Работа с ветками
- По

git switch -c <branch> <tag>   =  git checkout -b  <branch> <tag>

HEAD  -  служебный указатель на директорию, загруженную в рабочую

git log  --outline --all --decorate   команда вывода веток


#### Работа с форматированием и выводом

- Узнать хе комита
  ```
  git rev-parce имя ветки
  ```
- Расширенный вывод истории
  ```
  git log -g ветка
  ```
- Поиск комитита родителя.  ^ - указать родителя,  ~ - посмотреть  родителя родителя.
  ```
  git show HEAD^
  ```
- Найти в каком комите добавили те или иные строчки
  ```
  git log -Sимя_поиска_слитно_с_буквой_S --oneline
  ```
- Помогает найти найти комит где помистили неработающий код.К примеру Мы знаем комит когда код работал и когда код перестал работать.Эти команды нас будут помещать на середину между комитами  пока не найдем нужный последний удачный комит.Пишем good или bad пока не найдем нужный.
  ```
  git bisect start
  git bisect bad
  git bisect good имя_комита_тега
  git bisect reset
  ```
  Можно автоматизировать процесс выше.Результат выхода скрипта 0- хороший; 1- плохой.
  ```
  git bisect start плохой_коммит хороший_коммит
  git bisect run скрипт для тестирования (ex. script.sh)
  ```
- Сливаем коммиты вместе.В примере ниже мы в интерактивном режиме откроем изменение последний 3 комитов в 4-ый.
  ```
  git rebase -i HEAD~3
  ```
- Удалить кактой то файл во всех комитах в ветке!!!!Перезапиет все коммиты
  ```
  git filter-branch --tree-filter 'тут команда' HEAD
  git filter-branch --tree-filter 'rm -f password.txt' HEAD
  ```
  --tree-filter - лезет в каждый комит и удаляет файл,если файла нет то просто идет дальше
  --commit-filter - седержимое комита

- ОТКАТИТЬ merge коммит.
  - Перезапись истории и откат на прошлый комит
     ```
     git reset --hard HEAD~
     ```
  - Отменить через добавление комита ключ -m.
     ```
     get revert -m 1 HEAD
     Git revert -m 1 <коммит начиная откуда или HEAD)
     ```
 
### Rebase Merge
- Что бы слить ветку fix в main,нужно перейти в вветку main и ввести команду merge fix.
  ```
  git checkout main
  git merge fix
  ```
- Что бы в ветку main залить данные через rebase.Идем в ветку которую хотим залить,вводим ребейс и имя ветку куда бедет перписывать комиты,потом возвращаемся в основную ветку и делаем мердж - что бы HEAD основной ветки переместился в конец.
  ```
  git checkout fix
  git rebase main
  git checkout main
  git merge fix
  ```
### Подпись для коммитов


- Установка пакетов для использования ключей
```
apt install gpg2 gnupg

- Настраиваем агента.Для этого в файл добавляем use-agent.
```
nano ~/.gnupg/gpg.conf
use-agent
```
- Настраиваем терминал для работы с gpg.Нужно в оболочку добавить export GPG_TTY=`tty` и перезапускаем оболочку.
Для примера выбираем нужную нам оболочку
~/.bash_profile
~/.bashrc
~/.zshrc
```
nano ~/.bashrc
export GPG_TTY=`tty`
source ~/.bashrc
```
- Забираем доступ у группы и остальных пользователей.
```
$ chmod og-rwx ~/.gnupg
```

- Создаём GPG-ключ.

```
gpg --full-gen-key
```
Выбираем следующие параметры:
RSA (sign only)
Keysize 4096
Valid 3y
y
Gubochkin Alex
s161988@gmail.com
my_key
o



- Получаем список ключей и создаем публичный ключк

```
gpg -k
pg -K --keyid-format SHORT

Получаем идентификатор ключа.Нас интересует значение ######## :
sec rsa4096/######## YYYY-MM-DD [SC] [expires: YYYY-MM-DD]

Создаем пуб. ключ.######## - значение берем из прошлого шага.
```
gpg --armor --export ######## > public.gpg
```

- Полученный ключ сохраняем и передаем тому кто будет проверять подпись.К примеру гитхабу

> [!NOTE]На github.com данная процедура делается следующим образом:

> Переходим в "Settings" -> "SSH and GPG keys" (прямая ссылка)

> Нажимаем кнопку "New GPG key".

> Вставляем содержимое файла в поле "Key"

> Нажимаем кнопку "Add GPG key".

> Готово!
#### Настройки гита
- Через какую программу использовать подписи комитов.Далее указываем сертификат для подписи ####### - значение берем из прошлого шага.Настраиваем подпись комитов по умолчанию.
 ```
 git config --global gpg.program $(which gpg)
 git config --global user.signingkey ########
 git config --global commit.gpgsign true
 ```
 Теперь при создании тега указываем -s для того что бы использовалась подпись при комите все будет автоматом
 
На github.com данная процедура делается следующим образом:

Переходим в "Settings" -> "SSH and GPG keys" 

Нажимаем кнопку "New GPG key".

Вставляем содержимое файла в поле "Key"

Нажимаем кнопку "Add GPG key".

Готово!
----  
Ссылки на полезные ресурсы
1. https://git-scm.com/docs/git-log
2. https://webhamster.ru/mytetrashare/index/mtb0/143575842521lohpnj4q #Pull fetch
3. https://git-scm.com/book/ru/v2/Git-%D0%B8%D0%B7%D0%BD%D1%83%D1%82%D1%80%D0%B8-%D0%A1%D0%B0%D0%BD%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D0%BA%D0%B0-%D0%B8-%D0%A4%D0%B0%D1%80%D1%84%D0%BE%D1%80#ch10-git-internals Внут кухня
4. https://git-scm.com/book/ru/v2/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B-Git-%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-Git-%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D1%8F#ch02-git-basics-chapter Базис
