# Домашнее задание к занятию «Docker. Часть 2»
# Все команды и этапы по дз описаны в файле [ТУТ](https://github.com/Pomidor20/notology/blob/main/Netology/%D0%A0%D0%B0%D0%B7%D0%B1%D0%B8%D1%80%D0%B0%D0%B5%D0%BC%20Docker%20Compose%20%D1%84%D0%B0%D0%B9%D0%BB.md)


### Оформление домашнего задания

1. Домашнее задание выполните в [Google Docs](https://docs.google.com/) и отправьте на проверку ссылку на ваш документ в личном кабинете.  
1. В названии файла укажите номер лекции и фамилию студента. Пример названия: 6.4. Docker. Часть 2 — Александр Александров.
2. Код решения размещайте в отдельном файле на вашем Google-диске, это облегчит проверку вашей работы.
3. Перед отправкой проверьте, что доступ для просмотра открыт всем, у кого есть ссылка. Если нужно прикрепить дополнительные ссылки, добавьте их в свой Google Docs.

**Правила выполнения заданий к занятию «6.4. Docker. Часть 2»**

- Все задания выполняйте на основе конфигов из лекции. 
- В заданиях описаны те параметры, которые необходимо изменить. 
- Если параметр не упомянут вообще, значит, его нужно оставить таким, какой он был в лекции. 
- Если в каком-то задании, например, в задании 2, нужно изменить параметр, подразумевается, что во всех следующих заданиях будет использоваться уже изменённый параметр.
- Выполнив все задания без звёздочки, вы должны получить полнофункциональный сервис.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

## Важно

Перед отправкой работы на проверку удаляйте неиспользуемые ресурсы. Это нужно, чтобы предупредить неконтролируемый расход средств, полученных после использования промокода.

Рекомендации [по ссылке](https://github.com/netology-code/sdvps-homeworks/tree/main/recommend).
 
---

### Задание 1

**Напишите ответ в свободной форме, не больше одного абзаца текста.**

Установите Docker Compose и опишите, для чего он нужен и как может улучшить вашу жизнь.



### Ответ 1
Docker-Compose - это локальная оркестрация.Ускоряет время создания контейнеров,сети,изменений.
---

### Задание 2 

**Выполните действия и приложите текст конфига на этом этапе.** 

Создайте файл docker-compose.yml и внесите туда первичные настройки: 

 * version;
 * services;
 * networks.

При выполнении задания используйте подсеть 172.22.0.0.
Ваша подсеть должна называться: <ваши фамилия и инициалы>-my-netology-hw.


### Ответ 2
```
version: "3.8"
services:

networks:
  gubochkin.A.U-my-netology-hw: # Имя сети
    driver: bridge # Можеть быть bridge(что то типо NAT),host(изолированная,контейнеры видят только друг друга и не выходит в мир),none (как бы есть и нет)
    ipam: #IPAM расшифровывается как "IP Address Management" (Управление IP-адресами).Управляет настройками IP адресов
  config:
	    - subnet: 172.22.0.0
```
---

### Задание 3 

**Выполните действия и приложите текст конфига текущего сервиса:** 

1. Установите PostgreSQL с именем контейнера <ваши фамилия и инициалы>-netology-db. 
2. Предсоздайте БД <ваши фамилия и инициалы>-db.
3. Задайте пароль пользователя postgres, как <ваши фамилия и инициалы>12!3!!
4. Пример названия контейнера: ivanovii-netology-db.
5. Назначьте для данного контейнера статический IP из подсети 172.22.0.0/24.


### Ответ 3
 ```
 version: "3.8"
 services:
  netology-db # Имя Сервиса
   image: postgres:latest # Используем образ PostgreSQL
   container_name: GubochkinA-netology-db
   ports:# Порты, которые мы пробрасываем с нашего докер сервера внутрь контейнера
   - 5432:5432
   volumes:# Папка, которую мы пробросим с докер сервера внутрь контейнера
   - /opt/postgres/pg_data:/var/lib/postgresql/data/pgdata
   environment: # Переменные среды
      POSTGRES_PASSWORD: Gubochkin12!3!! # Задаём пароль от пользователя postgres
      POSTGRES_DB: gubochkin_db # БД которая сразу же будет создана
      PGDATA: /var/lib/postgresql/data/pgdata # Путь внутри контейнера, где будет папка pgdata
    networks:
	  gubochkin.A.U-my-netology-hw:  # Подключаем контейнер к сети
	    ipv4_address: 172.22.0.2  # Задаем статический IP-адрес для контейнера.
		aliases: # Как другие контейнеру будут к нему обращаться
		  netology-db
	restart: always
             #no: политика перезапуска по умолчанию. Он не перезапускает контейнер ни при каких обстоятельствах.
             #always: политика всегда перезапускает контейнер до его удаления.
             #on-failure: политика перезапускает контейнер, если код выхода указывает на ошибку.
             #unless-stopped: политика перезапускает контейнер независимо от кода выхода, но прекращает перезапуск при остановке или удалении
	  
	  
networks:
  gubochkin.A.U-my-netology-hw # Имя сети
    driver: bridge # Можеть быть bridge(что то типо NAT),host(изолированная,контейнеры видят только друг друга и не выходит в мир),none (как бы есть и нет)
	ipam: #IPAM расшифровывается как "IP Address Management" (Управление IP-адресами).Управляет настройками IP адресов
	  config:
	    - subnet: 172.22.0.0
 ```
---

### Задание 4 

**Выполните действия:**

1. Установите pgAdmin с именем контейнера <ваши фамилия и инициалы>-pgadmin. 
2. Задайте логин администратора pgAdmin <ваши фамилия и инициалы>@ilove-netology.com и пароль на выбор.
3. Назначьте для данного контейнера статический IP из подсети 172.22.0.0/24.
4. Прокиньте на 80 порт контейнера порт 61231.

В качестве решения приложите:

* текст конфига текущего сервиса;
* скриншот админки pgAdmin.


### Ответ 4
```
version: "3.8"
services:
  netology-db # Имя Сервиса
   image: postgres:latest # Используем образ PostgreSQL
   container_name: GubochkinA-netology-db
   ports: # Порты, которые мы пробрасываем с нашего докер сервера внутрь контейнера
   - 5432:5432
   volumes: # Папка, которую мы пробросим с докер сервера внутрь контейнера
   - /opt/postgres/pg_data:/var/lib/postgresql/data/pgdata
   environment: # Переменные среды
      POSTGRES_PASSWORD: Gubochkin12!3!! # Задаём пароль от пользователя postgres
      POSTGRES_DB: gubochkin_db # БД которая сразу же будет создана
      PGDATA: /var/lib/postgresql/data/pgdata # Путь внутри контейнера, где будет папка pgdata
    networks:
	  gubochkin.A.U-my-netology-hw:  # Подключаем контейнер к сети
	    ipv4_address: 172.22.0.2  # Задаем статический IP-адрес для контейнера.
		aliases: # Как другие контейнеру будут к нему обращаться
		  netology-db
	restart: always
             #no: политика перезапуска по умолчанию. Он не перезапускает контейнер ни при каких обстоятельствах.
             #always: политика всегда перезапускает контейнер до его удаления.
             #on-failure: политика перезапускает контейнер, если код выхода указывает на ошибку.
             #unless-stopped: политика перезапускает контейнер независимо от кода выхода, но прекращает перезапуск при остановке или удалении

  pgadmin
  image: dpage/pgadmin4:latest
  container_name: gubochkin-pgadmin
  ports:
  - 61231:80
  environment: # Переменные среды
      PGADMIN_DEFAULT_EMAIL: gubochkin@ilove-netology.com
      PGADMIN_DEFAULT_PASSWORD: 123 # Задаём пароль от пользователя postgres
  networks:
	  gubochkin.A.U-my-netology-hw:  # Подключаем контейнер к сети
	    ipv4_address: 172.22.0.3  # Задаем статический IP-адрес для контейнера.
		aliases: # Как другие контейнеру будут к нему обращаться
		  pgadmin
	restart: always  

networks:
  gubochkin.A.U-my-netology-hw # Имя сети
    driver: bridge # Можеть быть bridge(что то типо NAT),host(изолированная,контейнеры видят только друг друга и не выходит в мир),none (как бы есть и нет)
	ipam: #IPAM расшифровывается как "IP Address Management" (Управление IP-адресами).Управляет настройками IP адресов
	  config:
	    - subnet: 172.22.0.0
```
![картинка](https://github.com/Pomidor20/notology/blob/main/Netology/%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/pic/docker2.4.JPG)
---

### Задание 5 

**Выполните действия и приложите текст конфига текущего сервиса:** 

1. Установите Zabbix Server с именем контейнера <ваши фамилия и инициалы>-zabbix-netology. 
2. Настройте его подключение к вашему СУБД.
3. Назначьте для данного контейнера статический IP из подсети 172.22.0.0/24.

```
  zabbi-srv: #Имя Сервиса тут запускам zabbixserver
    image: zabbix/zabbix-server-pgsql:latest
    container_name: gubochkin-zabbix-netology
    ports:
    - 10051:10051
	links:
	- netology-db
    environment: # Переменные среды
      DB_SERVER_HOST: '117.22.0.2'
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: 'Gubochkin12!3!!'
    networks:
      gubochkin.A.U-my-netology-hw:  # Подключаем контейнер к сети
        ipv4_address: 172.22.0.4  # Задаем статический IP-адрес для контейнера.
        aliases: # Как другие контейнеру будут к нему обращаться
          - zabbi-srv
    restart: always

```
---

### Задание 6

**Выполните действия и приложите текст конфига текущего сервиса:** 

1. Установите Zabbix Frontend с именем контейнера <ваши фамилия и инициалы>-netology-zabbix-frontend. 
2. Настройте его подключение к вашему СУБД.
3. Назначьте для данного контейнера статический IP из подсети 172.22.0.0/24.

### Ответ 6
```
  zabbi-gui: #Имя Сервиса тут запускам zabbixserver
    image: zabbix/zabbix-web-apache-pgsql:latest
    container_name: gubochkin-netology-zabbix-frontend
    ports:
    - 443:8443
    - 80:8880
    links:
    - netology-db
    - zabbi-srv
    environment: # Переменные среды
      DB_SERVER_HOST: '117.22.0.2'
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: 'Gubochkin12!3!!'
      ZBX_SERVER_HOST: "zabbix_gui"
      PHP_TZ: "Europe/Moscow"
    networks:
      gubochkin.A.U-my-netology-hw:  # Подключаем контейнер к сети
        ipv4_address: 172.22.0.5  # Задаем статический IP-адрес для контейнера.
        aliases: # Как другие контейнеру будут к нему обращаться
          - zabbi-gui
    restart: always
```
---

### Задание 7 

**Выполните действия.**

Настройте линки, чтобы контейнеры запускались только в момент, когда запущены контейнеры, от которых они зависят.

В качестве решения приложите:

* текст конфига **целиком**;
* скриншот команды docker ps;
* скриншот авторизации в админке Zabbix.

### Ответ 7
![картинка](https://github.com/Pomidor20/notology/blob/main/Netology/%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/pic/docker2.7.1.JPG)
![картинка](https://github.com/Pomidor20/notology/blob/main/Netology/%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/pic/docker2.7.JPG)
Все команды и этапы по дз описаны в файле [ТУТ](https://github.com/Pomidor20/notology/blob/main/Netology/%D0%A0%D0%B0%D0%B7%D0%B1%D0%B8%D1%80%D0%B0%D0%B5%D0%BC%20Docker%20Compose%20%D1%84%D0%B0%D0%B9%D0%BB.md)
---

### Задание 8 

**Выполните действия:** 

1. Убейте все контейнеры и потом удалите их.
1. Приложите скриншот консоли с проделанными действиями.

### Ответ 8
```
docker rmi $(docker images -aq)
docker rm $(docker ps -aq)
```
---

## Дополнительные задания* (со звёздочкой)

Их выполнение необязательное и не влияет на получение зачёта по домашнему заданию. Можете их решить, если хотите лучше разобраться в материале.

---

### Задание 9* 

Запустите свой сценарий на чистом железе без предзагруженных образов.

**Ответьте на вопросы в свободной форме:**

1. Сколько ушло времени на то, чтобы развернуть на чистом железе написанный вами сценарий?
2. Чем вы занимались в процессе создания сценария так, как это видите вы?
3. Что бы вы улучшили в сценарии развёртывания?

### Ответ 9
```
real    1m5.923s
user    0m0.501s
sys     0m1.967s

```
